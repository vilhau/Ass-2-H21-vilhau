---
title: "Ass_2"
author: "Christoffersen J. & Haugland V."
date: "Oktober 14. 2021"
output:
  pdf_document: default
  html_notebook: default
---

# Del 1 - Innledning

Bare en liten test.

## Kort innledning

Det eksisterer en mengde ulike faktorer som vil være med på å bestemme et individs inntekt. For eksempel, i tilskrivnings-kulturer som Japan er status noe som blir tildelt for hvem eller hva en person er, framfor hvordan de utfører sine oppgaver. Dette er et nokså bredt eksempel på tvers av kulturer, men forskning har vist at det er en rekke biologiske faktorer som bestemmer hvordan vi mennesker tildeler status og annerkjennelse, ergo. hvor mye individer kan forvente å tjene. Disse faktorene vil ikke være absolutt avgjørende, men de har tendenser og er blant annet at blondiner tjener mer enn brunetter, skallete menn tjener mindre enn menn med fullt hår og at høye individer tjener mer enn lave individer. Det sistnevnde gjelder spesielt for menn og faktoren angående høyde kommer være problemstillingen vår for dette mini-paperet som er *Er det høyde som bestemmer inntekt?*. For å belyse denne problemstillingen skal vi benytte oss av datasettet *heights* fra R-pakken *modlr*, og gjennomføre en rekke ulike regresjonsanalyser med henhold til hvordan *høyde* og en rekke andre variabler påvirker inntekten. Resultatene fra disse analysene sklal videre benyttes til lineære hypotesetester, hvor vi skal undersøke og konkludere variablen *høyde* sin effekt på inntekt. 

## Kort litteraturgjennomgang på ca. 1 side

For å anskaffe en bredere forståelse av dette fenomenet med høyde sin påvirkning på individets inntekt, skal vi kort gjennomgå artikkelen *The Effect of Physical Hieght on Workplace Sucess and Income: Prelimitary Test of a Theoretical Model*. Her undersøkte de forholdet mellom høyde og hvilken type karrieresuksess individene hadde. Resultatene fremviste at fysisk høyde har en signifikant påvirkning på individets sosiale aktelse, ledelse fremheving og ytelse **(Judge et al., 2004)** 

Det eksisterer mange underliggende faktorerer som er med på å påvirke hvorfor høyde er så ønskelig. For det første er høye individer ansett som potensielt mer suksessfulle enn de som er lavere. En grunn til dette er at høyde er en sosialt ønskelig ressurs med mange goder. For eksempel, vil de som er høye bli betraktet som mer overbevisende, mer attraktiv som partner og ha en større sannsynlighet for å bli en fremtidig leder. For å illustrere sistnevnte, så kan vi se at det ikke har blitt utvalgt en president i USA som er lavere enn den gjennomsnittlige høyden helt siden 1896 **(Judge et al., 2004)**. Høydens viktighet er ikke bare observert blant mennesker, men vi ser den også i dyreriket. For dyrene er høyde noe som er svært enkelt å observere og dermed blir brukt som en indeks for dens makt og styrke, noe som spesielt fremvises i livstruende situasjoner. Vi kan dermed si fra et slikt sosiobiologisk perspektiv, at høyde vil tilegne seg makt og makt er noe som videre fører til respekt. I jobbsammenhenger kan høydens viktighet bli fremvist tydligere, med henhold til at dette er en arena hvor faktorer som overtalelse og makt er ansett som uhyrlig viktige. Det er gjennomført flere ulike undersøkelser på høyde innen jobbsammenhenger og de viser blant annet betyningen når det kommer til hvordan høye salgspersoner blir betraktet i større grad og at lave politibetjenter kan forvente en større grad av klager enn høye politbetjenter **(Judge et al., 2004)**.

For å forstå disse underliggende faktorene til høyde kan vi benytte den teoretiske modellen for forholdet mellom høyde og karriere til å forklare dette sosiale fenomenet. For det første vil høyde ha en stor betydning for hvordan vi betrakter oss selv, altså vår selvtillit og selvfølelse. Med henhold til at høyde er sterkt korrelert med sosial makt, vil lave individer stå i fare for å være misfornøyde med sin fysiske form, og denne usikkerheten vil være med på å påvirke personligheten deres. Et ekstremt eksempel på dette vil være det som kalles *Napoleon kompleks*, hvor individets høyde har så stor negativ betydning som fører til at denne mangelen på høyde fører til at man føler seg utilstrekkelig som individ, som resulterer i en svært aggresiv opptreden **(Just et al., 2003)**

Høyde vil i likhet med selvtillitten påvirke hvordan individet vil bli betraktet av andre, altså den sosiale aktelsen. For eksempel, vil dette i stor grad føre til høyere objektiv ytelse, som er jobb eller oppgave utfall og resultater. Noe som kan spesielt observeres i situasjoner hvor sosiale interaksjoner er ansett som viktige. Dette kan fremvises ved at kunder tenderer til å gi mer betraktning mot høye individer, som gjør at de i større grad kommer kjøpe av en høy salgsperson. Denne berudringen vil også være essensiell i andre sammenehenger, slikt som å opprette tillit, motta informasjon og mer effektiv forhandling **(Judge et al., 2004)**, som vil resultere i økt effektivitet og ytelse. Individets egne selvtilitt vil også ha en stor påvirkning på ytelsen. En positiv selvtillitt er nært knyttet til høyere ytelse ved at slike individer gjerne blir ansett som mer gunstige og er dermed lettere likt blant andre. 

Det siste steget i modellen forklarer hvordan denne ytelsen vil ha en påvirkning på videre suksess i karrieren. Med den økte sosiale aktelsen og selvtilittien det høye individet innehar, vil resultere i høyere ytelse. Denne ytelsen gjennom mer effektiv produktiviet vil dermed føre til organisatoriske belønninger som blant annet høyere lønninger og forfremmelser.

- Judge, T. A., & Cable, D. M. (2004). The effect of physical height on workplace success and income: preliminary test of a theoretical model. Journal of Applied Psychology, 89(3), 428.

- Just, W., & Morris, M. R. (2003). The Napoleon complex: why smaller males pick fights. Evolutionary Ecology, 17(5), 509-522.


```{r}
library(modelr)
library(dplyr)
library(ggplot2)
```

```{r}
# Endrer navn på datasettet fra heights til hoyde
data("heights", package = "modelr")
hoyde <- heights
```

## Beskrivende statistikk

I datasettet hoyde har vi $n=7006$, som vil si at settet består av totalt 7006 ulike observasjoner. Videre har vi de 7 uavhengige variabelene *høyde*, *vekt*, *alder*, *sivilstatus*, *kjønn*, *utdannelse* og *afqt* (Score fra forvarets kvalifiseringstest), som bestemmer den avhengige variablen *inntekt* i dette settet. Hvorav variablene *sivilstatus* og *kjønn* er såkalte dummyvariabler. *Sivilstatus* varier med fem ulike faktorer som er *singel*, *gift*, *separert*, *skilt* og *enke* og dummyvariablen *kjønn* varier mellom tallet 1 og 2 som bestemmer om individet som er observert er enten mann eller kvinne.

## EDA

- **Histogram**

```{r}
hist(hoyde$income, breaks = 100)
```

- **Forklaring på utliggerne langt til høyre**

For å forklare utliggerne langt til høyere, kan vi begynne med å finne ut hva maksimumsverdien av variablen *income* er.

```{r}
summary(hoyde)
```

Fra summeringstabellen ser vi at maksimumsverdien til variablen *income* er 343,830. Videre kan vi undersøke hvor mange av de observerte som innehar denne verdien.

```{r}
sum(hoyde$income == 343830)
```

Totalt var det 7006 observasjoner og med hensyn til at 143 hadde maksimumsverdien og at det er en relativt stor avstand mellom maksinntekten og medianen til datasettet, kan vi si at utliggerne til høyere representerer ca. 2% av det totale utvalget.

```{r}
(143/7006)*100
```

- **Har vi med personer uten inntekt i datasettet?**

Ja. Datasettet inneholder observasjoner av en rekke individer uten inntekt. Dette kan vi enkelt observere ved å se på histogrammet på 0 langs x-aksen, hvor vi ser at frekvensen på denne verdien er $<1500$. Vi kan også benytte summeringstabellen fra tidligere og se på minimumsverdien til variablen *income* som er på 0. Dersom vi ønsker å finne ut hvor mange av de observerte som innehar denne verdien, kan vi benytte følgende:

```{r}
sum(hoyde$income == 0)
```

# Del 2 - Regresjonsanalyse

## Redusere datasettet

Med henhold til at vi har funnet ut at datasettet inneholder mange minimumsverdier på 0 og at maksimumsverdien på 343,830 utgjorde kun 2% av utvalget, skal vi fjerne disse verdiene for å kunne kjøre en endelig modell mot reduserte datasett. Dette gjør vi for å teste modellens robushet. 

```{r}
sample1=filter(hoyde,income!=0 & income!=343830)
```

Her har vi opprettet en ny model, under navnet *sample1*. For å sjekke om de riktige verdiene ble fjernet kan vi kjøre en ny summeringstabell.

```{r}
summary(sample1)
```

Her kan vi se at både minimums- og makismumsverdien har endret seg. Det nye datasettet inneholder også færre observasjoner:
$$7006-143-1740=5123$$
Ny $n=5123$ til datasettet *sample1*.

## Mutering av eksisterende variabler fra imperial- til metric system

Siden vi benytter oss av det metriske systemet i Norge og datasettet har brukt det imperiske, så ønsker vi å endre disse variablene. Variablene dette omhandler er *height* og *weight* som vi skal gjøre om til *height_cm* og *weight_kg*. Har funnet ut på nettet at en inch er 2.54 cm og en pund er ca. 0.45 kg.

```{r}
hoyde <- hoyde %>%
  mutate(height_cm = height * 2.54)
```

- **Vi kan teste om muteringen av *height* fungerer ved å:**

```{r}
# Finne maksverdien av den nye variablen
max(hoyde$height_cm)
```

```{r}
# Vi kan sjekke at dette stemmer ved å se hva den høyeste i inches er
max(hoyde$height)
```

```{r}
# Og så gange med 2.54 som var overgangen fra inches til cm
84*2.54
```

```{r}
# Bruker samme fremgangsmåte for pund til kg
hoyde <- hoyde %>%
  mutate(weight_kg = weight *0.45)
```

Fra summeringstabellen til datasettet *hoyde* kan vi se at variablen *weight* har flere NA-verdier, altså verdier som ikke er tilgjengelige. Dersom man ønsker å finne ut hva for eksempel maksimumsverdien til *weight_kg* er må man skrive følgende:

```{r}
max(hoyde$weight_kg, na.rm = TRUE)
```

Vi putter inn $na.rm = TRUE$ slik at R utelater cellene med betegnelsen *NA* (Not available). Dette gjør at vi kun får cellene med tallverdier.

Dersom man ønsker å finne ut om andre variabler også innehar verdier som er NA, kan vi skrive:

```{r}
# For å sjekke hvilke celler som har NA
colSums(is.na(hoyde))
```

## Opprettelse av ny variabel BMI

```{r}
hoyde <- hoyde %>%
  mutate(hoyde, bmi = weight_kg/(height_cm)^2)
```

## Forenklet utgave av variablen martial

Siden dummyvariabel *marital* innholdt hele 5 ulike faktorer, så ønsker vi å forenkle denne til enten "True" eller "False" for om individet er gift eller ikke-gift. 

```{r}
hoyde <- hoyde %>%
  mutate(
    married = factor(
      case_when(
        marital == "married" ~ TRUE,
        TRUE ~ FALSE
      )
    )
  )
```

# Del 3 - Estimere modeller


```{r}
lm1 <- lm(income ~ height_cm, data = hoyde )
lm2 <- lm(income ~ height_cm + weight_kg + education, data = hoyde)
lm3 <- lm(income ~ height_cm + sex + age + education, data = hoyde)
```

## Test interaksjon

```{r}
m_educsex_i <- "income ~ education*sex"
lm_educsex_i <- lm(m_educsex_i, data = hoyde)
```

```{r}
summary(lm_educsex_i)
```

```{r}
summary(lm2)
```

```{r}
library(huxtable)
```

```{r}
huxreg(lm1, lm2, lm3)
```

## Redusert datasett


```{r}
# Legge til height_cm i redusert datasett (sample1)
sample1 <- sample1 %>%
  mutate(height_cm = height * 2.54)
```

```{r}
# Legge til weight_kg i redusert datasett (sample1)
sample1 <- sample1 %>%
  mutate(weight_kg = weight *0.45)
```

```{r}
# Legge til bmi i sample1
sample1 <- sample1 %>%
  mutate(sample1, bmi = weight_kg/(height_cm)^2)
```

```{r}
# Legge til forenklet utgave av marrital i sample1
sample1 <- sample1 %>%
  mutate(
    married = factor(
      case_when(
        marital == "married" ~ TRUE,
        TRUE ~ FALSE
      )
    )
  )
```


```{r}
lm4 <- lm(income ~ height_cm, data = sample1)
lm5 <- lm(income ~ height_cm + weight_kg + education, data = sample1)
lm6 <- lm(income ~ height_cm + sex + age + education, data = sample1)
```

```{r}
summary(lm5)
```

```{r}
huxreg(lm4, lm5, lm6)
```

```{r}
huxreg(
  list("Modell 1" = lm1, "Modell 4" = lm4),
  error_format = "[{statistic}]",
  note = "Regresjonstabell 1: {stars}. T statistics in brackets."
)
```

```{r}
huxreg(
  list("Modell 2" = lm2, "Modell 5" = lm5),
  error_format = "[{statistic}]",
  note = "Regresjonstabell 2: {stars}. T statistics in brackets."
)
```

```{r}
huxreg(
  list("Modell 3" = lm3, "Modell 6" = lm6),
  error_format = "[{statistic}]",
  note = "Regresjonstabell 3: {stars}. T statistics in brackets."
)
```

## Interaksjon på redusert datasett

```{r}
m_educsex_i <- "income ~ education*sex"
lm_educsex_iI <- lm(m_educsex_i, data = sample1)
```

```{r}
summary(lm_educsex_iI)
```

```{r}
library(car)
```

```{r}
summary(lm6)
```



